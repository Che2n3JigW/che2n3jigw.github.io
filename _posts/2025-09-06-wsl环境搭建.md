---
categories： Env
---
## 执行标准安装命令

```shell
wsl --install
```

![install]({{ site.baseurl }}/assets/images/env/wsl/install.png)

- Create a default Unix user account: **这里输入你的用户名**
- New password / Retype new password: **这里输入你的密码**



看到这个提示符意味着你的 **WSL 环境已经成功安装并运行起来了**。你现在已经在一个正在运行的 Linux 系统内部。

> 注意：这时候安装的是默认版本。
>
> 如果不想要当前版本，希望安装使用别的发行版本：
>
> 1. 查询当前已安装发行版[跳转](#列出已安装分发版)
> 2. 注销指定的发行版本[跳转](#注销（卸载）原分发版)
> 3. 查询可用的发行版本[跳转](#查看可用发行版)
> 4. 安装指定的发行版本[跳转](#安装指定版本)
>
> 需要注销发行版后指定安装发行版



## 查看可用发行版

```shell
wsl.exe --list --online
```

- **目的：** 确认官方支持的Linux发行版列表，并选择特定版本进行安装。



## 安装指定版本

```shell
wsl --install Ubuntu-24.04
```



## 列出已安装分发版

```shell
wsl --list --verbose
```

- **输出结果：**

  ```shell
    NAME            STATE           VERSION
  * Ubuntu-24.04    Stopped         2
  ```

  

- **结论：** 环境已成功搭建，WSL版本为2，分发版为Ubuntu-24.04。



## 注销（卸载）原分发版

```shell
wsl --unregister Ubuntu-24.04
```



------

# 迁移WSL分发版至非系统盘

**动机：** 默认安装的WSL分发版存储在系统盘（C盘），长期使用会占用大量空间，故需迁移至F盘。

## 导出发行版（备份为vhdx文件）

```shell
# 在目标目录（F:\wsl\Ubuntu_24_04）下执行
wsl --export --vhd Ubuntu-24.04 2404.vhdx
```

- **参数说明：**
  - `--export`: 导出命令。
  - `--vhd`: 指定导出格式为VHDX虚拟硬盘文件（推荐，便于后续管理）。
  - `Ubuntu-24.04`: 要导出的分发版名称。
  - `2404.vhdx`: 导出的目标文件名。
- **结果：** 成功生成约1.3GB的`2404.vhdx`文件。



## 导入发行版到新位置

```shell
wsl --import --vhd Ubuntu-24.04 F:\wsl\Ubuntu_24_04 2404.vhdx
```

- **参数说明：**
  - `--import`: 导入命令。
  - `--vhd`: 指定导入源文件为VHDX格式。
  - `Ubuntu-24.04`: 为新分发版命名（可与原名相同）。
  - `F:\wsl\Ubuntu_24_04`: **分发版的存储目录**。WSL会在此目录下管理虚拟硬盘文件。
  - `2404.vhdx`: 之前导出的备份文件。
- **结果：** 操作成功完成。新的Ubuntu-24.04分发版现已存储在`F:\wsl\Ubuntu_24_04`目录下。

## 验证新分发版的存储路径

```shell
(Get-ChildItem -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Lxss | Where-Object { $_.GetValue("DistributionName") -eq 'Ubuntu-24.04' }).GetValue("BasePath") + "\ext4.vhdx"
```

- **说明：** 此PowerShell命令查询注册表，确认分发版`Ubuntu-24.04`的虚拟硬盘文件路径。
- **输出结果：** `\\?\F:\wsl\Ubuntu_24_04\ext4.vhdx`
- **结论：** 确认分发版已成功迁移至F盘指定路径。

------

#### 最终状态与总结

- **当前状态：** WSL2环境已就绪，Ubuntu 24.04 LTS分发版已稳定运行，且其数据存储于`F:\wsl\Ubuntu_24_04`目录下，不会占用系统盘空间。
- **成功关键：**
  1. 使用 `--vhd` 参数进行导出和导入，操作清晰可靠。
  2. 在导入命令中明确指定了目标存储目录。
  3. 通过查询注册表验证了迁移结果。
- **后续使用：** 只需执行 `wsl -d Ubuntu-24.04` 即可启动该Linux环境。
